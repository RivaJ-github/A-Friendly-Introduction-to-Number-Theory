\chapter{线性方程和最大公因数}
\begin{theorem}[线性方程定理]
设$a$与$b$是非零整数，$g=\gcd(a,b)$。方程
\[ax+by=g\]
总是有一个整数解$(x_1, y_1)$，它可由欧几里得算法得到。则方程的每一个解可由
\[\left(x_1+k\cdot\frac{b}{g}, y_1-k\cdot\frac{a}{g}\right)\]
得到，其中$k$是任意整数。
\end{theorem}
%
\exercise a）$12345\cdot 11 - 67890\cdot 2=\gcd(12345, 67890) = 15$\par
b）$-54321\cdot 1645 + 9876\cdot 9048 = \gcd(54321, 9876) = 3$
%
\exercise 
a）$105\cdot(-53)+121\cdot46=1$。一般解为$(-53+121k, 46-105k)$\par
b）$12345\cdot11+67890\cdot(-2)=15$。一般解为$(11+4526k, -2-823k)$\par
c）$54321\cdot(-1645)+9876\cdot9048=3$。一般解为$(-1645+3292k, 9048-18107k)$
%
\exercise 
a）{\bf 提示：}每次迭代后$w$是新产生的余数，$g$上一次迭代产生的余数。$v$是形如$r_i = ax + by$中的$x$。而$x$则记录的是$r_{i-1} = ax + by$中的$x$。\par
b）python实现如下：
\begin{lstlisting}
def gcdWithXY(a, b):
    x, g, v, w = 1, a, 0, b
    while (w != 0):
        t = g % w
        q = g // w
        s = x - q * v
        x, g = v, w
        v, w = s, t
    return (g, x, (g - a * x) // b)
\end{lstlisting}
c）运行code/exe6\_3.py。
\begin{gather*}
\gcd(19789, 23548) = 7\quad (x,y)=(1303,-1095) \\
\gcd(31875, 8387) = 1\quad (x,y)=(-381,1448) \\
\gcd(22241739, 19848039) = 237\quad (x,y)=(-8980,10063)
\end{gather*}
d）添加特殊处理：
\begin{lstlisting}
    if (b == 0):
        return (a, 1, 0)
\end{lstlisting}
e）在返回前添加校验：
\begin{lstlisting}
    while (x <= 0):
        x += b
\end{lstlisting}
%
\exercise a）首先解$6X+15Y=\gcd(6, 15)=3$，其中一个解是$X=3$，$Y=-1$。
接下来解$3W+20Z=1$。其中一个解是$W=7$，$Z=-1$。即方程
\[(6X+15Y)W + 20Z = 1\]
有解$X=3$，$Y=-1$，$W=7$，$Z=-1$。将方程变形为：
\[6XW+15YW + 20Z = 1\]
因此，原方程有一个解为$x=XW=21$，$y=YW=-7$，$z = Z=-1$。\par
b）$ax+by+cz=1$有整数解，当且仅当$a$，$b$，$c$只有一个公因子1。\par
\proof 必要性：假设$a$，$b$，$c$有公因子$d$，则$d$整除$ax+by+cz$，同时$d$整除1，所以$d$只能是1。\par
充分性：如果$a$，$b$，$c$没有公因子，可通过如下步骤得到一个解。首先解$aX+bY=g=\gcd(a,b)$。因为$a$，$b$，$c$没有公因子，所以$g$和$c$没有公因子。因此可以找到$gW+cZ=1$的解。于是
\[(aX+bY)W +cZ=1\]
最终我们得到解$x=XW$，$y=YW$，$z=Z$\par
c）首先，解$155X+341Y=\gcd(155, 341)=31$，得到一个较小的解$X=-2$，$Y=1$。接下来解$31W+385Z=1$。得到一个解$W=-149$，$Z=12$。于是得到原式的一个解$x=298$，$y=-149$，$z=12$。
%
\exercise \proof 已知$ax+by=\gcd(a,b)=1$比有整数解，记为$x=X$，$y=Y$，即$aX+bY=1$，两边乘以$c$得到$acX+bcY=c$。因此原式有解$x=cX$，$y=cY$\par
解$37x+47y=\gcd(37, 47)=1$，得到$x=14$，$y=-11$，所以$(x,y)=(14*103, -11*103)=(1442, -1133)$是原式的解。于是$(1442 - 47k, -1133+37k)$也是原式的解。令$k=31$，得到一个较小的解$(-15, 14)$
%
\exercise a）
b）
c）
d）
e）