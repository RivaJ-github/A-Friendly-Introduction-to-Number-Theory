from tools import RSA

# for question a)
# p = 187963
# q = 163841
# k = 48611
# code = [5272281348, 21089283929, 3117723025, 26844144908, 22890519533, 26945939925, 27395704341, 2253724391, 1481682985, 2163791130, 13583590307, 5838404872, 12165330281, 28372578777, 7536755222]

# for question b)
p = 123456789012345681631
q = 7746289204980135457
k = 12398737
code = [821566670681253393182493050080875560504, 87074173129046399720949786958511391052, 552100909946781566365272088688468880029, 491078995197839451033115784866534122828, 172219665767314444215921020847762293421]


rsa = RSA(p * q, k, (p-1) * (q-1))

msg = [rsa.decode(i) for i in code]
print(msg)

def decode_number(n):
    s = str(n)
    codes = [s[i:i+2] for i in range(0, len(s), 2)]
    return ''.join([chr(int(c) + 54) for c in codes])


decoded_message = ''.join(
    decode_number(m) 
    for m in msg
)
print(decoded_message)