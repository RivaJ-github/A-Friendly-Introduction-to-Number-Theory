\chapter{勾股数组}
\begin{theorem}[勾股数组定理]
每个本源勾股数组（$a$，$b$，  $c$）（其中$a$为奇数，$b$为偶数）都可从如下公式得出：
\[a=st,\quad b=\frac{s^2-t^2}{2},\quad c=\frac{s^2+t^2}{2}\]
其中$s>t\ge1$是任意没有公因数的奇数。
\end{theorem}
%
\exercise
a）如果$a$和$b$都不是3的倍数，则$a$等于$3m+1$或$3m+2$，$b$等于$3n+1$或$3n+2$。
存在四种可能性
\begin{align*}
a^2+b^2&=(3m+1)^2+(3n+1)^2=9m^2+9n^2+6m+6n+2\\
&=3(3m^2+3n^2+2m+2n)+2\\
a^2+b^2&=(3m+2)^2+(3n+1)^2=9m^2+9n^2+12m+6n+5\\
&=3(3m^2+3n^2+4m+2n+1)+2\\
a^2+b^2&=(3m+1)^2+(3n+2)^2=9m^2+9n^2+6m+12n+5\\
&=3(3m^2+3n^2+2m+4n+2)+2\\
a^2+b^2&=(3m+2)^2+(3n+2)^2=9m^2+9n^2+12m+12n+8\\
&=3(3m^2+3n^2+4m+4n+2)+2
\end{align*}
此时，$a^2+b^2$除以3的余数都是2。然而$c^2$的余数不可能是2，因为
\begin{align*}
(3z)^2 &= 3(3z^2) \\
(3z + 1)^2 &= 3(3z^2 + 2z) + 1 \\
(3z + 2)^2 &= 3(3z^2 + 4z + 1) + 1 
\end{align*}
b）表格显示，$a$，$b$，$c$中有且只有一个数是5的倍数。\par
\proof 根据勾股数组定理，$a=st$，$b=\frac{1}{2}(s^2-t^2)$，若$s$或$t$的任意一个数是5的倍数，则$a$是5的倍数；
否则，$s=5S+i$，$t=5T+j$，其中$i, j \in \{1,2,3,4\}$
\[2b=s^2-t^2=5(5S^2 +2Si - 5T^2-2Tj)+i^2-j^2\]
如果$i^2-j^2$是5的倍数，则$b$是5的倍数。此时，仅剩以下8种情况未证明：
\[(i,j) = (1,2), (1,3), (2,1), (2,4), (3,1), (3,4), (4,2), (4,3)\]
对于这些情况，我们需要证明，\[2c=s^2+t^2=5(5S^2 +2Si + 5T^2+2Tj)+i^2+j^2\]
是5的倍数，即$i^2+j^2$是5的倍数。
\begin{align*}
    1^2+2^2=5 &\quad 1^2+3^2=10 \\
    2^2+1^2=5 &\quad 2^2+4^2=20 \\
    3^2+1^2=10 &\quad 3^2+4^2=25 \\
    4^2+2^2=20 &\quad 4^2+3^2=25 
\end{align*}
得证
%
\exercise\proof
$d$整除$m$与$n \Leftrightarrow 
\exists$整数$k_1$，$k_2$使得$m=dk_1$，$n=dk_2$。
因此$m-n=d(k_1-k_2)$，$m+n=d(k_1+k_2)$。得证。
%
\exercise 
a）令$t=1$，则$a=st=s$，所以$a$可以是任意大于1的奇数\par
b）令$s=t+2$，$b=\frac{(s-t)(s+t)}{2}=2(t+1)$，因为$t$可以是任意奇数，
所以$b$可以是任意4的倍数。\par
c）这题很难证明，甚至很难给出猜想。运行code/exe2\_3\_c.py，得到$c$可能的值：
\[5, 13, 17, 25, 29, 37, 41, 53, 65, 61, 65, 73, 85, 101, 85, 89, 97, 109, 125, 145,  \cdots\]
也许你会发现所有的$c$被4除都余1，但是并不是所有被4除余1的数都可以是$c$。\par
事实上，$c$是被4除余1的素数的乘积（毕达哥拉斯斜边命题）。TODO: 阅读第25章。
%
\exercise 运行code/exe2\_4.py，得到如下结果：
\begin{align*}
85^2 &= 77^2 + 36^2 = 13^2 + 84^2 \\
1105^2 &= 1073^2 + 264^2 = 943^2 + 576^2 = 817^2 + 744^2 \\
1105^2 &= 1073^2 + 264^2 = 943^2 + 576^2 = 817^2 + 744^2 = 47^2 + 1104^2
\end{align*}    
%
\exercise a）$b=4T_5=60$，符合条件的本源数组有：
\[(899, 60, 901)\quad (221, 60, 229)\quad (91, 60, 109)\quad (11, 60, 61)\]
$b=4T_6=84$，符合条件的本源数组有：
\[(1763, 84, 1765)\quad (187, 84, 205)\quad (13, 84, 85)\]
$b=4T_7=112$，符合条件的本源数组有：
\[(3135, 112, 3137)\quad (15, 112, 113)\]
b）事实上练习2.3（b）已经告诉我们任何4的倍数都可以出现在本源勾股数组中。\par
对于本题，对于任意的$T_n$，至少存在一个本源勾股数组：
\[(2n+1, 4T_n, 4T_n+1)\]
%
\exercise
$c - a = \frac{s^2+t^2}{2} - st = 2 \Leftrightarrow (s-t)^2 = 4 \Leftrightarrow s- t = 2$\par
对于$s = t+2$，$t$为任意奇数，仍满足$\gcd(s, t) = 1$。\par
因此$(t^2+2t, 2t+2, t^2+2t+2)$都是本源勾股数组。
%
\exercise $2c-2a$总是平方数，证明略
%
\exercise a）$\frac{1}{4} + \frac{1}{6} = \frac{5}{12}$，
$\frac{1}{5} + \frac{1}{7} = \frac{12}{35}$，
$\frac{1}{6} + \frac{1}{8} = \frac{7}{24}$，
b）这些分子分母构成本源勾股数组的$a$和$b$\par
c）\proof 对于任意正整数$N$
\[\frac{1}{N} + \frac{1}{N+2} = \frac{2N+2}{N^2+2N}\]
由于$(2N+1)^2 + (N^2+2N)^2 = 4N^4+4N^3+8N^2+4=(N^2+2N+2)^2$
因此$2N+1$和$N^2+2N$构成一个勾股数组的两边。\par
其约分后必然构成本源勾股数组。
%
\exercise 略
